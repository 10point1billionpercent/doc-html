<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IQAC Document Repository</title>
  <style>
    html, body {
         background-color: #121212;
      color: #f5f5f5;
  height: 100%;
  margin: 0;
      padding: 2rem;
  overflow: hidden; /* Prevent scrolling of the main page when modal is open */
}


    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
    
    .header-container .spacer {
      visibility: hidden;
      width: 99px;
    }

    h1 {
      color: #0066cc;
      text-align: center;
      margin: 0;
      flex: 1;
    }

    .main-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .search-input {
      padding: 0.5rem 1rem;
      border-radius: 5px;
      border: 1px solid #444;
      background-color: #1e1e1e;
      color: #fff;
      width: 250px;
    }

    .sort-select {
      padding: 0.5rem;
      border-radius: 5px;
      border: 1px solid #444;
      background-color: #1e1e1e;
      color: #fff;
    }

    .button {
      padding: 0.6rem 1rem;
      border-radius: 5px;
      border: none;
      font-weight: bold;
      cursor: pointer;
      color: #fff;
    }

    .add-button {
      background-color: #0066cc;
    }

    .login-button {
      background-color: #0066cc;
    }

    .logout-button {
      background-color: #ff4d4d;
    }

    .document-list {
      list-style: none;
      padding: 0;
      max-width: 700px;
      margin: 0 auto;
    }

    .document-item {
      background-color: #1e1e1e;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .document-title {
      color: #0066cc;
      margin: 0 0 0.3rem 0;
    }

    .document-description {
      margin: 0.2rem 0;
      color: #ccc;
    }

    .document-meta {
      font-size: 0.9rem;
      color: #888;
    }

    .document-actions {
      display: flex;
      gap: 0.5rem;
    }

    .view-button {
      background-color: #0066cc;
    }
    
    .download-button {
      background-color: #0066cc;
    }

    .delete-button {
      background-color: #ff4d4d;
    }

    .no-documents-message {
      text-align: center;
      color: #888;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background-color: #1e1e1e;
      border-radius: 10px;
      padding: 1.5rem;
      color: #fff;
      position: relative;
  width: 100%;
  height: 100%;
  max-width: 100%;
  max-height: 100%;
  display: flex;
  flex-direction: column;
}


    .modal-content-add {
      max-width: 500px;
      width: 90%;
    }

    .modal-content-confirm {
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #444;
      padding-bottom: 1rem;
      margin-bottom: 1.5rem;
    }

    .modal-close-btn {
      background: none;
      border: none;
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title-add {
      color: #0066cc;
      margin: 0;
    }
    
    .modal-title-confirm {
      color: #ff4d4d;
      margin: 0;
    }

    .modal-form-item {
      display: block;
      margin-bottom: 1rem;
      padding: 0.5rem;
      width: 100%;
      border-radius: 5px;
      border: 1px solid #444;
      background-color: #2a2a2a;
      color: #fff;
    }
    
    .file-label {
      display: block;
      background-color: #2a2a2a;
      color: #0066cc;
      padding: 0.6rem 1rem;
      border-radius: 5px;
      border: 1px solid #444;
      cursor: pointer;
      text-align: center;
      margin-bottom: 1rem;
    }

    .modal-button-container {
      display: flex;
      justify-content: space-around;
      gap: 1rem;
    }
    
    .modal-button {
        padding: 0.6rem 1rem;
        border-radius: 5px;
        border: none;
        font-weight: bold;
        cursor: pointer;
        width: 100%;
        color: #fff;
    }
    
    .modal-button-confirm {
        background-color: #ff4d4d;
    }

    .modal-button-cancel {
        background-color: #555;
    }
    
    .modal-button-add {
        background-color: #0066cc;
    }
    
   #iframePdfViewerModal .iframe-container {
  flex-grow: 1;
  display: flex;
  justify-content: center;
}

    
    #iframePdfViewerModal.show .modal-content {
      transform: translateY(0);
    }

    .modal-title-view {
      color: #0066cc;
      margin: 0;
    }
    
    #iframePdfViewerModal .modal-header {
      padding: 1rem;
    }
    
    #iframePdfViewerModal .iframe-container {
      flex-grow: 1;
      display: flex;
      justify-content: center;
    }

    #iframePdfViewerModal iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>

  <div class="header-container">
    <div class="spacer"></div>
    <h1>IQAC Document Repository</h1>
    <div id="auth-button-container"></div>
  </div>

  <div class="main-content">
    <input type="text" id="search-input" class="search-input" placeholder="Search documents...">
    <select id="sort-select" class="sort-select">
      <option value="date">Sort by Date</option>
      <option value="title">Sort by Title</option>
    </select>
    <button id="add-document-button" class="button add-button">Add Document</button>
  </div>

  <ul id="document-list" class="document-list"></ul>

  <p id="no-documents-message" class="no-documents-message" style="display: none;">No documents found</p>

  <!-- Modals -->

  <!-- Add Document Modal -->
  <div id="addDocumentModal" class="modal-overlay">
    <div class="modal-content modal-content-add">
      <div class="modal-header">
        <h2 class="modal-title-add">Add New Document</h2>
        <button class="modal-close-btn" data-modal-close="addDocumentModal">&times;</button>
      </div>
      <form id="add-document-form">
        <input type="text" id="add-title" class="modal-form-item" placeholder="Document Title" required>
        <input type="text" id="add-description" class="modal-form-item" placeholder="Description" required>
        <label for="file-upload" id="file-label" class="file-label">Choose File</label>
        <input type="file" id="file-upload" style="display: none;" required>
        <button type="submit" class="button modal-button-add">Add Document</button>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteConfirmationModal" class="modal-overlay">
    <div class="modal-content modal-content-confirm">
      <div class="modal-header">
        <h2 class="modal-title-confirm">Confirm Deletion</h2>
        <button class="modal-close-btn" data-modal-close="deleteConfirmationModal">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 2rem;">Are you sure you want to delete this document?</p>
        <div class="modal-button-container">
          <button id="cancel-delete-button" class="button modal-button modal-button-cancel">Cancel</button>
          <button id="confirm-delete-button" class="button modal-button modal-button-confirm">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Iframe PDF Viewer Modal -->
  <div id="iframePdfViewerModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title-view">View Document</h2>
        <button class="modal-close-btn" data-modal-close="iframePdfViewerModal">&times;</button>
      </div>
      <div class="iframe-container">
        <iframe id="pdf-iframe" title="PDF Document"></iframe>
      </div>
    </div>
  </div>

  <script>
    // == Vanilla JS Logic ==
    const docList = document.getElementById('document-list');
    const searchInput = document.getElementById('search-input');
    const sortSelect = document.getElementById('sort-select');
    const addDocumentButton = document.getElementById('add-document-button');
    const authButtonContainer = document.getElementById('auth-button-container');
    const noDocumentsMessage = document.getElementById('no-documents-message');
    
    // Modals
    const addDocumentModal = document.getElementById('addDocumentModal');
    const deleteConfirmationModal = document.getElementById('deleteConfirmationModal');
    const iframePdfViewerModal = document.getElementById('iframePdfViewerModal');

    let documents = [
      { id: 1, title: "IQAC Annual Report 2023", description: "Annual internal quality assurance report", date: "2023-12-31", fileName: "sample.pdf", filePath: './sample.pdf' },
      { id: 2, title: "Meeting Minutes - Jan 2024", description: "Minutes of the IQAC meeting held on January 10, 2024", date: "2024-01-10", fileName: "sample.pdf", filePath: './sample.pdf' },
    ];
    let isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
    let docToDeleteId = null;
    let fileToView = null;
    let shouldAnimate = false;

    // --- State Management and Data ---

    function saveAuthStatus() {
      localStorage.setItem("isLoggedIn", isLoggedIn);
    }

    // --- UI Update Functions ---

    function renderAuthButton() {
      if (isLoggedIn) {
        authButtonContainer.innerHTML = `<button id="logout-button" class="button logout-button">Log Out</button>`;
        document.getElementById('logout-button').addEventListener('click', logout);
      } else {
        authButtonContainer.innerHTML = `<button id="login-button" class="button login-button">Log In</button>`;
        document.getElementById('login-button').addEventListener('click', () => {
          showModal(addDocumentModal); // In a real app, this would show a login modal
        });
      }
    }

    function renderDocuments() {
      const filteredDocs = documents.filter(doc =>
        doc.title.toLowerCase().includes(searchInput.value.toLowerCase()) ||
        doc.description.toLowerCase().includes(searchInput.value.toLowerCase())
      ).sort((a, b) => {
        if (sortSelect.value === 'title') return a.title.localeCompare(b.title);
        if (sortSelect.value === 'date') return new Date(b.date) - new Date(a.date);
        return 0;
      });

      docList.innerHTML = '';
      if (filteredDocs.length === 0) {
        noDocumentsMessage.style.display = 'block';
      } else {
        noDocumentsMessage.style.display = 'none';
        filteredDocs.forEach(doc => {
          const listItem = document.createElement('li');
          listItem.className = 'document-item';
          listItem.innerHTML = `
            <div>
              <h3 class="document-title">${doc.title}</h3>
              <p class="document-description">${doc.description}</p>
              <p class="document-meta">${doc.date} | ${doc.fileName}</p>
            </div>
            <div class="document-actions">
              <button class="button view-button" data-doc-id="${doc.id}">View</button>
              <button class="button download-button" data-doc-id="${doc.id}"><i class="fas fa-download"></i> Download</button>
              ${isLoggedIn ? `<button class="button delete-button" data-doc-id="${doc.id}">Delete</button>` : ''}
            </div>
          `;
          docList.appendChild(listItem);
        });
      }
      addEventListenersToButtons();
    }

    function addEventListenersToButtons() {
      docList.querySelectorAll('.view-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const docId = parseInt(e.target.dataset.docId);
          const doc = documents.find(d => d.id === docId);
          fileToView = doc.filePath;
          showModal(iframePdfViewerModal);
        });
      });

      docList.querySelectorAll('.download-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          alert('Downloading document...');
        });
      });

      docList.querySelectorAll('.delete-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
          docToDeleteId = parseInt(e.target.dataset.docId);
          showModal(deleteConfirmationModal);
        });
      });
    }

    // --- Modal Functions ---

    // Inside your <script> tag

function showModal(modalElement) {
  if (modalElement === iframePdfViewerModal) {
    const iframe = document.getElementById('pdf-iframe');
    const modalContent = modalElement.querySelector('.modal-content');
    
    // Add the fullscreen class
    modalContent.classList.add('modal-content-fullscreen');

    // Set the file source and zoom
    iframe.src = `${fileToView}#zoom=100`;

    // Trigger the slide-in animation
    setTimeout(() => {
      modalElement.style.display = 'flex';
      modalElement.classList.add('show');
    }, 10);
  } else {
    modalElement.style.display = 'flex';
  }
}

function hideModal(modalElement) {
  const modalContent = modalElement.querySelector('.modal-content');
  
  modalContent.classList.remove('modal-content-fullscreen');
  modalElement.classList.remove('show');

  modalElement.style.display = 'none';

  if (modalElement === iframePdfViewerModal) {
    const iframe = document.getElementById('pdf-iframe');
    iframe.src = '';
  }
}

// And ensure that your iframe has the `allowfullscreen` attribute set
// which it does in the HTML, so this is just for awareness.


    function hideModal(modalElement) {
      modalElement.style.display = 'none';
      if (modalElement === iframePdfViewerModal) {
        iframePdfViewerModal.classList.remove('show');
        const iframe = document.getElementById('pdf-iframe');
        iframe.src = ''; // Clear iframe src to stop playback
      }
    }

    // --- Event Handlers ---

    function login() {
      isLoggedIn = true;
      saveAuthStatus();
      renderAuthButton();
      renderDocuments();
    }

    function logout() {
      isLoggedIn = false;
      saveAuthStatus();
      renderAuthButton();
      renderDocuments();
    }

    addDocumentButton.addEventListener('click', () => {
      if (isLoggedIn) {
        showModal(addDocumentModal);
      } else {
        alert("Please sign in to add a document.");
      }
    });

    document.querySelectorAll('[data-modal-close]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const modalId = e.target.dataset.modalClose;
        hideModal(document.getElementById(modalId));
      });
    });

    document.getElementById('add-document-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const title = document.getElementById('add-title').value;
      const description = document.getElementById('add-description').value;
      const fileInput = document.getElementById('file-upload');
      const file = fileInput.files[0];

      if (!title || !description || !file) {
        alert("Please fill in all fields!");
        return;
      }

      const newDoc = {
        id: Date.now(),
        title,
        description,
        date: new Date().toISOString().split("T")[0],
        fileName: file.name,
        filePath: URL.createObjectURL(file),
      };

      documents.push(newDoc);
      renderDocuments();
      hideModal(addDocumentModal);
      e.target.reset();
      document.getElementById('file-label').textContent = 'Choose File';
    });

    document.getElementById('file-upload').addEventListener('change', (e) => {
      const fileName = e.target.files[0] ? e.target.files[0].name : 'Choose File';
      document.getElementById('file-label').textContent = fileName;
    });

    document.getElementById('confirm-delete-button').addEventListener('click', () => {
      documents = documents.filter(doc => doc.id !== docToDeleteId);
      hideModal(deleteConfirmationModal);
      renderDocuments();
    });

    document.getElementById('cancel-delete-button').addEventListener('click', () => {
      hideModal(deleteConfirmationModal);
    });
    
    searchInput.addEventListener('input', renderDocuments);
    sortSelect.addEventListener('change', renderDocuments);

    // Initial render
    renderAuthButton();
    renderDocuments();
  </script>

</body>
</html>
